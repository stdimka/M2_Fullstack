# –≠–º—É–ª—è—Ü–∏—è —Ä–∞–±–æ—Ç—ã –∫–ª–∞—Å—Ç–µ—Ä–∞ –Ω–∞ –æ–¥–Ω–æ–π –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ üëç  

–í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ, –ª–æ–∫–∞–ª—å–Ω–∞—è –º–∞—à–∏–Ω–∞ –±—É–¥–µ—Ç
- –∏ **Manager Node**,
- –∏ **Worker Node** –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ.

**Docker Swarm** —ç—Ç–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç: –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –æ–±—É—á–µ–Ω–∏—è –º–æ–∂–Ω–æ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å –∫–ª–∞—Å—Ç–µ—Ä –¥–∞–∂–µ –Ω–∞ –æ–¥–Ω–æ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ!

---

# –ö–∞–∫ —ç—Ç–æ —Å–¥–µ–ª–∞—Ç—å: –ø–ª–∞–Ω –¥–µ–π—Å—Ç–≤–∏–π

1. **–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å Swarm** –ø—Ä—è–º–æ –Ω–∞ –≤–∞—à–µ–π –º–∞—à–∏–Ω–µ.
2. **–°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª** `docker-compose.yml`, –ø–æ–¥—Ö–æ–¥—è—â–∏–π –¥–ª—è Swarm.
3. **–†–∞–∑–≤–µ—Ä–Ω—É—Ç—å —Å—Ç–µ–∫** —á–µ—Ä–µ–∑ `docker stack deploy`.
4. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É —Å–µ—Ä–≤–∏—Å–∞** —á–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥—ã —Ç–∏–ø–∞ `docker service ls`, `docker service ps`.

---

# –ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è

## 1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º Docker Swarm

```
docker swarm init
```

- –≠—Ç–æ –ø—Ä–µ–≤—Ä–∞—Ç–∏—Ç –≤–∞—à—É –º–∞—à–∏–Ω—É –≤ **Manager Node**.
- Docker –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—Å—Ç **overlay network**.
- –í—ã —É–≤–∏–¥–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –≤–æ—Ä–∫–µ—Ä–æ–≤ (`docker swarm join ...`), –Ω–æ –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞ —ç—Ç–æ –Ω–µ –Ω—É–∂–Ω–æ.

## 2. –°–æ–∑–¥–∞—ë–º —Ñ–∞–π–ª `docker-compose.yml`

–ü—Ä–∏–º–µ—Ä –ø—Ä–æ—Å—Ç–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è: **–≤–µ–±-—Å–µ—Ä–≤–µ—Ä Nginx**, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω –¥–æ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ä–µ–ø–ª–∏–∫.

```
services:
    web:
        image: nginx:alpine
        ports:
            - "8080:80"
        deploy:
            replicas: 3
        networks:
            - webnet

networks:
    webnet:
```

**–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:**
- `replicas: 3` ‚Äî —Ö–æ—Ç–∏–º 3 –∫–æ–ø–∏–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞.
- `placement: constraints` ‚Äî –æ–±—ã—á–Ω–æ —É–∫–∞–∑—ã–≤–∞—é—Ç "—Ç–æ–ª—å–∫–æ –Ω–∞ –≤–æ—Ä–∫–µ—Ä–∞—Ö", –Ω–æ –Ω–∞ –æ–¥–Ω–æ–π –º–∞—à–∏–Ω–µ —ç—Ç–æ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ (–º–æ–∂–Ω–æ —É–±—Ä–∞—Ç—å —Å—Ç—Ä–æ–∫—É).
- `networks` ‚Äî —Å–æ–∑–¥–∞—ë–º –≤–∏—Ä—Ç—É–∞–ª—å–Ω—É—é —Å–µ—Ç—å `webnet`, —á—Ç–æ–±—ã –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –º–æ–≥–ª–∏ –æ–±—â–∞—Ç—å—Å—è.

**–í–∞–∂–Ω–æ!**  
–í Swarm –≤ —Å–µ–∫—Ü–∏–∏ `deploy` —É–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ (`replicas`), –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞, –ª–∏–º–∏—Ç—ã —Ä–µ—Å—É—Ä—Å–æ–≤ –∏ —Ç.–¥.  
–í –æ–±—ã—á–Ω–æ–º Docker Compose –ø–æ–¥–æ–±–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞, –∑–∞–ø–∏—Å–∞–Ω–Ω–∞—è –≤ `docker-compose.yml` - –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è.  
(–°–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ—Å—Ç–∏ —Ä–∞–¥–∏ —Å—Ç–æ–∏—Ç –∑–∞–º–µ—Ç–∏—Ç—å, —á—Ç–æ —Ç–∞–º —Ä–µ–ø–ª–∏–∫–∞—Ü–∏—é –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ –º–æ–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –≤ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–µ: `docker compose up --scale worker=3`)

## 3. –†–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–µ–º —Å—Ç–µ–∫

–ß—Ç–æ —Ç–∞–∫–æ–µ —Å—Ç–µ–∫ (stack) –≤ Docker Swarm?

**–°—Ç–µ–∫ (stack)** ‚Äî —ç—Ç–æ –≥—Ä—É–ø–ø–∞ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤, –æ–±—ä–µ–¥–∏–Ω—ë–Ω–Ω—ã—Ö –≤ –µ–¥–∏–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏ —É–ø—Ä–∞–≤–ª—è—é—â–∏—Ö—Å—è –∫–∞–∫ –æ–¥–Ω–∞ –µ–¥–∏–Ω–∏—Ü–∞.

–ò–Ω—ã–º–∏ —Å–ª–æ–≤–∞–º–∏:
-  –ù–µ—Å–∫–æ–ª—å–∫–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, backend, frontend, –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö) –≤–º–µ—Å—Ç–µ —Å–æ—Å—Ç–∞–≤–ª—è—é—Ç –æ–¥–Ω–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ.
- –í—Å–µ –æ–Ω–∏ –æ–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ –æ–¥–Ω–æ–º —Ñ–∞–π–ª–µ (docker-compose.yml).
- –ü—Ä–∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–∏ –æ–Ω–∏ —É–ø—Ä–∞–≤–ª—è—é—Ç—Å—è —á–µ—Ä–µ–∑ –æ–¥–Ω–æ –∏–º—è —Å—Ç–µ–∫–∞.

–î–µ–π—Å—Ç–≤–∏—è Docker Swarm:
- –ó–∞–ø—É—Å—Ç–∏—Ç –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã,
- –°–≤—è–∂–µ—Ç –∏—Ö —Å–µ—Ç—è–º–∏,
- –ù–∞—Å—Ç—Ä–æ–∏—Ç –ø–æ—Ä—Ç—ã,
- –£–ø—Ä–∞–≤–ª—è–µ—Ç –∏—Ö –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ–º,
- –ò –±—É–¥–µ—Ç –≤—Å—ë —ç—Ç–æ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –∫–∞–∫ –æ–¥–∏–Ω –ª–æ–≥–∏—á–µ—Å–∫–∏–π –±–ª–æ–∫.

–°–æ–∑–¥–∞–¥–∏–º —Å—Ç–µ–∫ –ø–æ–¥ –∏–º–µ–Ω–µ–º, –Ω–∞–ø—Ä–∏–º–µ—Ä, `mystack`:

```
docker stack deploy -c docker-compose.yml mystack
```

**–†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞:**
- `-c docker-compose.yml` ‚Äî –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É –æ–ø–∏—Å–∞–Ω–∏—è —Å—Ç–µ–∫–∞.
- `mystack` ‚Äî –∏–º—è —Å—Ç–µ–∫–∞ (–∫–∞–∫ –∏–º—è –ø—Ä–æ–µ–∫—Ç–∞ –≤ Compose).

## 4. –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –≤—Å—ë –∑–∞–ø—É—Å—Ç–∏–ª–æ—Å—å

–ü–æ–∫–∞–∑–∞—Ç—å —É–∑–ª—ã (Nods):
```
docker node ls
```
(–¥–æ–ª–∂–µ–Ω –ø–æ—è–≤–∏—Ç—å—Å—è –æ–¥–∏–Ω —É–∑–µ–ª - —Å –∏–º–µ–Ω–µ–º –Ω–∞—à–µ–π –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω—ã)

–ü–æ–∫–∞–∑–∞—Ç—å —Å–ø–∏—Å–æ–∫ —Å–µ—Ä–≤–∏—Å–æ–≤ (–∑–∞–¥–∞—á –∏–ª–∏ Tasks):

```
docker service ls
```

(–¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —á—Ç–æ-—Ç–æ –≤—Ä–æ–¥–µ —ç—Ç–æ–≥–æ:)
```
ID             NAME          MODE         REPLICAS   IMAGE          PORTS
rvmh2v2td7do   mystack_web   replicated   3/3        nginx:alpine   *:8080->80/tcp
```
_–≥–¥–µ_:
- `NAME` ‚Äî –∏–º—è —Å–µ—Ä–≤–∏—Å–∞ (–≤ —Ñ–æ—Ä–º–∞—Ç–µ `stackname_servicename`, —Ç–æ –µ—Å—Ç—å `mystack_web`).
- `MODE = replicated` ‚Äî –∑–Ω–∞—á–∏—Ç —Å–µ—Ä–≤–∏—Å –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é —Ä–µ–ø–ª–∏–∫.
- `REPLICAS = 3/3` ‚Äî –∑–∞–ø—É—â–µ–Ω—ã 3 –∏–∑ 3 –æ–∂–∏–¥–∞–µ–º—ã—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤.
- `MAGE` ‚Äî –æ–±—Ä–∞–∑ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ (`nginx:alpine`).

–ü–æ–∫–∞–∑–∞—Ç—å –∑–∞–¥–∞—á–∏ –∫–∞–∂–¥–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞:

```
docker service ps mystack_web
```
(–¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —á—Ç–æ-—Ç–æ –≤—Ä–æ–¥–µ —ç—Ç–æ–≥–æ:)
```
ID             NAME            IMAGE          NODE                       DESIRED STATE   CURRENT STATE           ERROR     PORTS
v9gjwzg42lt5   mystack_web.1   nginx:alpine   su-HP-250-G8-Notebook-PC   Running         Running 4 minutes ago             
lfp6pxh85ho1   mystack_web.2   nginx:alpine   su-HP-250-G8-Notebook-PC   Running         Running 4 minutes ago             
052b5he5apmn   mystack_web.3   nginx:alpine   su-HP-250-G8-Notebook-PC   Running         Running 4 minutes ago             

```


–ü–æ–∫–∞–∑–∞—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã:

```
docker ps
```
(–¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —á—Ç–æ-—Ç–æ –≤—Ä–æ–¥–µ —ç—Ç–æ–≥–æ:)
```
CONTAINER ID   IMAGE          COMMAND                  CREATED         STATUS         PORTS     NAMES
40a289ebc2eb   nginx:alpine   "/docker-entrypoint.‚Ä¶"   5 minutes ago   Up 5 minutes   80/tcp    mystack_web.1.v9gjwzg42lt5fmxzyxui5ydi3
fbeef2ca86bc   nginx:alpine   "/docker-entrypoint.‚Ä¶"   5 minutes ago   Up 5 minutes   80/tcp    mystack_web.2.lfp6pxh85ho17efym9qhetdy1
f3ffa63ae9a5   nginx:alpine   "/docker-entrypoint.‚Ä¶"   5 minutes ago   Up 5 minutes   80/tcp    mystack_web.3.052b5he5apmnuhvhnckzs4kzn

```

## 5. –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ –±—Ä–∞—É–∑–µ—Ä–µ

–û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:  
`http://localhost:8080`

–í—ã —É–≤–∏–¥–∏—Ç–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—á–∫—É Nginx.

---

# –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

**–ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä—è–º–æ –≤ –±–æ—é:**

```
docker service scale mystack_web=5
```
(–¢—É—Ç –∂–µ –ø–æ–¥–Ω–∏–º–µ—Ç—Å—è –µ—â—ë 2 –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞!)

**–û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å—Ç–µ–∫–∞:**

```
docker stack rm mystack
```

**–í—ã—Ö–æ–¥ –∏–∑ Swarm:**

```
docker swarm leave --force
```

---

# –ö—Ä–∞—Ç–∫–∏–π –∏—Ç–æ–≥

| –®–∞–≥ | –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç |
|:----|:---------------|
| `docker swarm init` | –°–æ–∑–¥–∞—ë—Ç –∫–ª–∞—Å—Ç–µ—Ä –Ω–∞ –æ–¥–Ω–æ–π –º–∞—à–∏–Ω–µ. |
| `docker stack deploy` | –†–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–µ—Ç –≤—Å—ë –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∫–∞–∫ —Å—Ç–µ–∫ —Å–µ—Ä–≤–∏—Å–æ–≤. |
| `docker service` | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞–º–∏: –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å, –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å, –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å. |

---
