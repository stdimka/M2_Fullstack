## ‚öôÔ∏è –†–∞–±–æ—Ç–∞ —Å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è–º–∏ –∏ —Å–µ–∫—Ä–µ—Ç–∞–º–∏ –≤ Docker (`docker config` –∏ `docker secret`)

### üìå –ß—Ç–æ —ç—Ç–æ?

Docker –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –º–µ—Ö–∞–Ω–∏–∑–º—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è **–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–º–∏ —Ñ–∞–π–ª–∞–º–∏** (`docker config`) –∏ **—Å–µ–∫—Ä–µ—Ç–∞–º–∏** (`docker secret`) –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ **Docker Swarm** ‚Äî –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤. –≠—Ç–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –ø–æ–∑–≤–æ–ª—è—é—Ç —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ —É–ø—Ä–∞–≤–ª—è—Ç—å –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π, —Ä–∞–∑–≤—ë—Ä–Ω—É—Ç—ã—Ö –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ.

---

### üéØ –ö–∞–∫–∏–µ –∑–∞–¥–∞—á–∏ —Ä–µ—à–∞–µ—Ç?

* **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –°–µ–∫—Ä–µ—Ç—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–∞—Ä–æ–ª–∏, API-–∫–ª—é—á–∏) –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–º –≤–∏–¥–µ –∏ –¥–æ—Å—Ç—É–ø–Ω—ã —Ç–æ–ª—å–∫–æ —Ç–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º, –∫–æ—Ç–æ—Ä—ã–º —ç—Ç–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–æ.
* **–ò–∑–æ–ª—è—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏**: –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –º–æ–∂–Ω–æ –º–µ–Ω—è—Ç—å –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –æ–±—Ä–∞–∑–æ–≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π ‚Äî —ç—Ç–æ —É–ø—Ä–æ—â–∞–µ—Ç —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ.
* **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ —É—Ä–æ–≤–Ω–µ –∫–ª–∞—Å—Ç–µ—Ä–∞**: –í—Å—ë —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –≤ Docker Swarm, —á—Ç–æ –¥–∞—ë—Ç —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å.

---

### üìÖ –ö–æ–≥–¥–∞ –∏ –∫–∞–∫ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è?

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `config` –∏ `secret` –æ–ø—Ä–∞–≤–¥–∞–Ω–æ –≤ —Å–ª–µ–¥—É—é—â–∏—Ö —Å–ª—É—á–∞—è—Ö:

* –í—ã —Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–µ—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —á–µ—Ä–µ–∑ **Docker Swarm**.
* –í–∞–º –Ω—É–∂–Ω–æ **–±–µ–∑–æ–ø–∞—Å–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å –ø–∞—Ä–æ–ª–∏, —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –∏–ª–∏ –∫–ª—é—á–∏** –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã.
* –í–∞–º –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º **–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã** (–Ω–∞–ø—Ä–∏–º–µ—Ä, `nginx.conf`, `app.conf`) –±–µ–∑ –∂—ë—Å—Ç–∫–æ–≥–æ –≤–∫–ª—é—á–µ–Ω–∏—è –∏—Ö –≤ Docker-–æ–±—Ä–∞–∑—ã.
* –í—ã —Ö–æ—Ç–∏—Ç–µ **–æ–±–Ω–æ–≤–ª—è—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏–ª–∏ —Å–µ–∫—Ä–µ—Ç—ã –±–µ–∑ –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∏ –æ–±—Ä–∞–∑–æ–≤**.

–ü—Ä–∏–º–µ—Ä —Å—Ü–µ–Ω–∞—Ä–∏—è:

* –£ –≤–∞—Å –µ—Å—Ç—å –≤–µ–±-—Å–µ—Ä–≤–µ—Ä nginx, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª;
* –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö —Å –ø–æ–º–æ—â—å—é –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –ø–∞—Ä–æ–ª—è;
* –í—Å–µ —ç—Ç–∏ –¥–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º —Å –ø–æ–º–æ—â—å—é `docker config` –∏ `docker secret`.

---

### üìÅ 1. `docker config`: –†–∞–±–æ—Ç–∞ —Å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è–º–∏

#### ‚úÖ –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

–°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:

```bash
docker config create <config_name> <file>
```

–ü—Ä–∏–º–µ—Ä:

```bash
docker config create nginx_conf nginx.conf
```

–ü—Ä–æ—Å–º–æ—Ç—Ä —Å–ø–∏—Å–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π:

```bash
docker config ls
```

–ü—Ä–æ—Å–º–æ—Ç—Ä —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:

```bash
docker config inspect --pretty <config_name>
```

–£–¥–∞–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:

```bash
docker config rm <config_name>
```

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ —Å–µ—Ä–≤–∏—Å–µ:

```bash
docker service create \
  --name webserver \
  --config source=nginx_conf,target=/etc/nginx/nginx.conf \
  nginx:alpine
```

#### üìù –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

* –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –¥–æ—Å—Ç—É–ø–Ω—ã –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º –≤ —Ä–µ–∂–∏–º–µ "—Ç–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ".
* –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –º–æ–Ω—Ç–∏—Ä—É—é—Ç—Å—è –∫–∞–∫ —Ñ–∞–π–ª –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞.

---

### üîê 2. `docker secret`: –†–∞–±–æ—Ç–∞ —Å —Å–µ–∫—Ä–µ—Ç–∞–º–∏

#### ‚úÖ –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

–°–æ–∑–¥–∞–Ω–∏–µ —Å–µ–∫—Ä–µ—Ç–∞:

```bash
echo "my_db_password" | docker secret create db_pass -
```

–°–ø–∏—Å–æ–∫ —Å–µ–∫—Ä–µ—Ç–æ–≤:

```bash
docker secret ls
```

–ü—Ä–æ—Å–º–æ—Ç—Ä –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö —Å–µ–∫—Ä–µ—Ç–∞:

```bash
docker secret inspect <secret_name>
```

–£–¥–∞–ª–µ–Ω–∏–µ —Å–µ–∫—Ä–µ—Ç–∞:

```bash
docker secret rm <secret_name>
```

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ —Å–µ—Ä–≤–∏—Å–µ:

```bash
docker service create \
  --name db \
  --secret db_pass \
  mysql:5.7
```

–í–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ —Å–µ–∫—Ä–µ—Ç –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –ø—É—Ç–∏:

```
/run/secrets/db_pass
```

#### üìù –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

* –°–µ–∫—Ä–µ—Ç—ã –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã –≤–Ω–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –∏ —à–∏—Ñ—Ä—É—é—Ç—Å—è –≤ –ø–∞–º—è—Ç–∏.
* –ö–∞–∂–¥—ã–π —Å–µ–∫—Ä–µ—Ç –º–æ–∂–Ω–æ –ø–æ–¥–∫–ª—é—á–∏—Ç—å —Ç–æ–ª—å–∫–æ –∫ –Ω—É–∂–Ω—ã–º —Å–µ—Ä–≤–∏—Å–∞–º.

---

### üîç –°—Ä–∞–≤–Ω–µ–Ω–∏–µ `config` –∏ `secret`

| –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞  | `docker config`              | `docker secret`                 |
| --------------- | ---------------------------- | ------------------------------- |
| –¢–∏–ø –¥–∞–Ω–Ω—ã—Ö      | –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã       | –ö–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ         |
| –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ   | NGINX, –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ | –ü–∞—Ä–æ–ª–∏, —Ç–æ–∫–µ–Ω—ã, –ø—Ä–∏–≤–∞—Ç–Ω—ã–µ –∫–ª—é—á–∏ |
| –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å     | –¢–æ–ª—å–∫–æ –≤ Swarm               | –¢–æ–ª—å–∫–æ –≤ Swarm                  |
| –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å    | –û–±—ã—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ               | –®–∏—Ñ—Ä—É–µ—Ç—Å—è –≤ –ø–µ—Ä–µ–¥–∞—á–µ –∏ –≤ –ø–∞–º—è—Ç–∏ |
| –ì–¥–µ –º–æ–Ω—Ç–∏—Ä—É–µ—Ç—Å—è | –í –ª—é–±–æ–º –º–µ—Å—Ç–µ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ   | –¢–æ–ª—å–∫–æ –≤ `/run/secrets/<name>`  |

---

### üõ† –ü—Ä–∏–º–µ—Ä —Å `docker-compose`

```yaml
version: '3.8'

services:
  app:
    image: my_app_image
    deploy:
      replicas: 1
    secrets:
      - db_user
      - db_password
    configs:
      - source: app_config
        target: /etc/myapp/app.conf

secrets:
  db_user:
    external: true
  db_password:
    external: true

configs:
  app_config:
    external: true
```

–ü–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å–µ–∫—Ä–µ—Ç—ã –∏ –∫–æ–Ω—Ñ–∏–≥–∏ —Å–æ–∑–¥–∞–Ω—ã —á–µ—Ä–µ–∑ `docker secret create` –∏ `docker config create`.