# –°–æ–∑–¥–∞–Ω–∏–µ –ë–î PostgresSQL –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ, –¥–∞–º–ø, –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ –¥–∞–º–ø–∞

## üêò 1. –ó–∞–ø—É—Å–∫ PostgreSQL –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ —Å —Ç–æ–º–æ–º

–°–æ–∑–¥–∞–π—Ç–µ —Ç–æ–º –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö:
```
docker volume create pgdata
```
–ó–∞–ø—É—Å—Ç–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä:
```
docker run -d \
  --name my_postgres \
  -e POSTGRES_USER=myuser \
  -e POSTGRES_PASSWORD=mypassword \
  -e POSTGRES_DB=mydb \
  -v pgdata:/var/lib/postgresql/data \
  -p 5432:5432 \
  postgres:17
```
–≥–¥–µ:
- `myuser`, `mypassword`, `mydb` ‚Äî –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –ø–∞—Ä–æ–ª—å –∏ –∏–º—è –ë–î
- `-v pgdata:/var/lib/postgresql/data` ‚Äî –º–æ–Ω—Ç–∏—Ä—É–µ—Ç –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ.
- `-p 5432:5432` ‚Äî –ø—Ä–æ–±—Ä–∞—Å—ã–≤–∞–µ—Ç –ø–æ—Ä—Ç –Ω–∞ —Ö–æ—Å—Ç-–º–∞—à–∏–Ω—É.
- `postgres:17` ‚Äî –æ–±—Ä–∞–∑ PostgreSQL –≤–µ—Ä—Å–∏–∏ 17.

## üíæ 2. –°–æ–∑–¥–∞–Ω–∏–µ –±—ç–∫–∞–ø–∞ (–¥–∞–º–ø–∞) –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
```
docker exec -t my_postgres pg_dump -U myuser -d mydb > mydb_backup.sql
```
–†–µ–∑—É–ª—å—Ç–∞—Ç–æ–º –±—É–¥–µ—Ç —Ñ–∞–π–ª `mydb_backup.sql` –Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ –≤ —Ç–µ–∫—É—â–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏.

–ï—Å–ª–∏ –±—ç–∫–∞–ø –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –µ—â—ë –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞:
```
docker exec -t my_postgres pg_dump -U myuser -d mydb -f /backup/mydb_backup.sql
```
–ù–æ –¥–ª—è —ç—Ç–æ–≥–æ –Ω—É–∂–Ω–æ —Å–º–æ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–∞—Ç–∞–ª–æ–≥:
```
mkdir pg_backups
docker run -d \
  --name my_postgres \
  -e POSTGRES_USER=myuser \
  -e POSTGRES_PASSWORD=mypassword \
  -e POSTGRES_DB=mydb \
  -v pgdata:/var/lib/postgresql/data \
  -v $(pwd)/pg_backups:/backup \
  -p 5432:5432 \
  postgres:17
```

## ‚ôªÔ∏è 3. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –∏–∑ –¥–∞–º–ø–∞

### 3.1. –ù–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ–∑–¥–∞—Ç—å –ø—É—Å—Ç—É—é –±–∞–∑—É

–°–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π —Å–ø–æ—Å–æ–± –≤ –Ω–∞—à–µ–π —Å–∏—Ç—É–∞—Ü–∏–∏ - —É–¥–∞–ª–∏—Ç—å –ë–î –∏–∑ —Ç–æ–ª—å–∫–æ —á—Ç–æ —Å–æ–∑–¥–∞–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –∏ —Ç—É—Ç –∂–µ —Å–æ–∑–¥–∞—Ç—å –µ—ë –∑–∞–Ω–æ–≤–æ.    
–≠—Ç–∞ –æ–ø–µ—Ä–∞—Ü–∏—è –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ —Å–æ–∑–¥–∞—Å—Ç –ø—É—Å—Ç—É—é –±–∞–∑—É —Å –Ω—É–∂–Ω—ã–º –Ω–∞–º –∏–º–µ–Ω–µ–º `mydb`.
–î–ª—è —ç—Ç–æ–≥–æ –≤—ã–ø–æ–ª–Ω—è–µ–º –∫–æ–º–∞–Ω–¥—É:  
```
docker exec -it my_postgres psql -U myuser -d postgres
```
–≥–¥–µ
- `docker exec -it my_postgres` - –∑–∞–ø—É—Å–∫ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞ –≤ —Ç–æ–ª—å–∫–æ —á—Ç–æ —Å–æ–∑–¥–∞–Ω–Ω–æ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ PostgreSQL
- `psql` - –∫–æ–º–∞–Ω–¥–∞ –∑–∞–ø—É—Å–∫–∞–µ—Ç –∫–ª–∏–µ–Ω—Ç –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ PostgreSQL
- `-U myuser` - –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –æ—Ç –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è  `myuser`
- `-d postgres` - –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–∏—Å—Ç–µ–º–Ω–æ–π –±–∞–∑–µ `postgres` –¥–∞—ë—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Ä–µ—à–∞—Ç—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏ (—Å–æ–∑–¥–∞–Ω–∏–µ/—É–¥–∞–ª–µ–Ω–∏–µ –ë–î)

–î–∞–ª–µ–µ, –≤ –æ–∫–Ω–µ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞ –∑–∞–ø—É—Å–∫–∞–µ–º –∫–æ–º–∞–Ω–¥—ã —É–¥–∞–ª–µ–Ω–∏—è –∏ —Å–æ–∑–¥–∞–Ω–∏—è –ë–î `mydb`, –∏ –∫–æ–º–∞–Ω–¥—ã –≤—ã–∑
```sql
DROP DATABASE IF EXISTS mydb;  -- —É–¥–∞–ª–µ–Ω–∏–µ –ë–î `mydb`
CREATE DATABASE mydb;          -- —Å–æ–∑–¥–∞–Ω–∏–µ –ë–î `mydb`
\q                             -- –≤—ã—Ö–æ–¥ –∏–∑ –∫–ª–∏–µ–Ω—Ç–∞ `psql`
```

### 3.2. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–∑—ã –∏–∑ –¥–∞–º–ø–∞

–î–∞–º–ø –ë–î `cat mydb_backup.sq`, —Å–æ–∑–¥–∞–Ω–Ω—ã–π –≤ –ø—Ä–µ–¥—ã–¥—É—â–µ–º –ø—É–Ω–∫—Ç–µ, –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Ä–∞–±–æ—Ç –∫–∞—Ç–∞–ª–æ–≥–µ.
–ü–æ—ç—Ç–æ–º—É, –∫–æ–º–∞–Ω–¥–∞:
```
cat mydb_backup.sql | docker exec -i my_postgres psql -U myuser -d mydb
```
—Å—á–∏—Ç–∞–µ—Ç —ç—Ç–æ—Ç –¥–∞–º–ø –∏ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–∏—Ç –µ–≥–æ –≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –ø–æ—Ç–æ–∫ –≤–≤–æ–¥–∞ (`stdin`) –∫–æ–º–∞–Ω–¥—ã `docker exec -i my_postgres psql -U myuser -d mydb`.
–≠—Ç–∞ –∫–æ–º–∞–Ω–¥–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç –≤—Å–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–∞–º–ø–∞ –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç –ë–î –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ `my_postgres`.


