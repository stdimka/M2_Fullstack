# –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤

–¢—Ä—É–¥–Ω–æ —É—á–∏—Ç—å—Å—è –∏–≥—Ä–∞—Ç—å –Ω–µ –≥–∏—Ç–∞—Ä–µ –±–µ–∑ –≥–∏—Ç–∞—Ä—ã.
–ü–æ—ç—Ç–æ–º—É —Å–æ–∑–¥–∞–¥–∏–º –º–∏–∫—Ä–æ-–ø—Ä–æ–µ–∫—Ç `my_project` –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –∏–∑—É—á–µ–Ω–∏—è docker.

## üîß –ß—Ç–æ –±—É–¥–µ—Ç –≤ –ø—Ä–æ–µ–∫—Ç–µ:

- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä 1: 
  - API-—Å–µ—Ä–≤–µ—Ä –Ω–∞ Python (—Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Flask) ‚Äî –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—Ä–æ—Å—Ç–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ.

- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä 2: 
  - –ö–ª–∏–µ–Ω—Ç –Ω–∞ Python ‚Äî —Ä–∞–∑ –≤ 5 —Å–µ–∫—É–Ω–¥ –¥–µ–ª–∞–µ—Ç –∑–∞–ø—Ä–æ—Å –∫ API –∏ –ø–µ—á–∞—Ç–∞–µ—Ç –æ—Ç–≤–µ—Ç.

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
```
docker-demo/
‚îÇ
‚îú‚îÄ‚îÄ api/
‚îÇ   ‚îú‚îÄ‚îÄ app.py
‚îÇ   ‚îú‚îÄ‚îÄ Dockerfile
‚îÇ   ‚îî‚îÄ‚îÄ requirements.txt
‚îÇ
‚îú‚îÄ‚îÄ client/
‚îÇ   ‚îú‚îÄ‚îÄ client.py
‚îÇ   ‚îú‚îÄ‚îÄ Dockerfile
‚îÇ   ‚îî‚îÄ‚îÄ requirements.txt
‚îÇ
‚îú‚îÄ‚îÄ docker-compose.yml
‚îî‚îÄ‚îÄ README.md (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
```
### üì¶ –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä 1: API

—Ñ–∞–π–ª `api/app.py`:

```
from flask import Flask
app = Flask(__name__)

@app.route("/")
def hello():
    return "–ü—Ä–∏–≤–µ—Ç –∏–∑ API!"

if __name__ == "__main__":
    app.run(host="0.0.0.0", port=5000)
```

—Ñ–∞–π–ª  `api/requirements.txt`:
```
flask
```

### üì¶ –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä 2: –ö–ª–∏–µ–Ω—Ç

—Ñ–∞–π–ª  `client/client.py`:

```
import time
import requests

while True:
    try:
        response = requests.get("http://api:5000/")
        print("–û—Ç–≤–µ—Ç –æ—Ç API:", response.text)
    except Exception as e:
        print("–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ –∫ API:", e)
    time.sleep(5)
```

—Ñ–∞–π–ª `client/requirements.txt`:
```
requests
```

### üß± docker-compose.yml
```
version: "3.9"

services:
    api:
        build: ./api
        container_name: api-container
        ports:
            - "5000:5000"

    client:
        build: ./client
        container_name: client-container
        depends_on:
            - api
```
### üê≥ Dockerfile'—ã

—Ñ–∞–π–ª `api/Dockerfile`:
```
FROM python:3.12-slim
WORKDIR /app
COPY requirements.txt .
RUN pip install -r requirements.txt
COPY app.py .
CMD ["python", "app.py"]
```
—Ñ–∞–π–ª `client/Dockerfile`:
```
FROM python:3.12-slim
WORKDIR /app
COPY requirements.txt .
RUN pip install -r requirements.txt
COPY client.py .
CMD ["python", "-u", "client.py"]
```
**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: `-u` ‚Äî —ç—Ç–æ —Ñ–ª–∞–≥ Python, –∫–æ—Ç–æ—Ä—ã–π –æ–∑–Ω–∞—á–∞–µ—Ç `unbuffered` —Ä–µ–∂–∏–º:  
–≤—ã–≤–æ–¥ (`stdout` –∏ `stderr`) –±—É–¥–µ—Ç —Å—Ä–∞–∑—É –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å—Å—è –≤ –∫–æ–Ω—Å–æ–ª—å, –±–µ–∑ –∑–∞–¥–µ—Ä–∂–∫–∏ –Ω–∞ –±—É—Ñ–µ—Ä–∏–∑–∞—Ü–∏—é.


##üöÄ –ó–∞–ø—É—Å–∫
### 1. C –ø–æ–º–æ—â—å—é `docker-compose`

 1. –ü–µ—Ä–µ–π—Ç–∏ –≤ –∫–æ—Ä–µ–Ω—å –ø—Ä–æ–µ–∫—Ç–∞:
```
cd docker-demo
```
 2. –°–æ–±—Ä–∞—Ç—å –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ–µ–∫—Ç:
```
docker-compose up --build
```

–û—Ç–ª–∏—á–Ω—ã–π –∏ —É–¥–æ–±–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç, –Ω–æ `docker-compose` –º—ã –µ—â—ë –Ω–µ –ø—Ä–æ—Ö–æ–¥–∏–ª–∏.  
–ü–æ—ç—Ç–æ–º—É —Å–æ–∑–¥–∞—ë–º –∏ –∑–∞–ø—É—Å–∫–∞–µ–º —É–∂–µ –∏–∑–≤–µ—Å—Ç–Ω—ã–º —Å–ø–æ—Å–æ–±–æ–º:

### 2. "–†—É—á–Ω–æ–π –≤–∞—Ä–∏–∞–Ω—Ç" - —Å–æ–∑–¥–∞—ë–º –∏ –∑–∞–ø—É—Å–∫–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ
===========================================================
#### üì¶ 1. –°–Ω–∞—á–∞–ª–∞ —Å–æ–∑–¥–∞–¥–∏–º –æ–±—Ä–∞–∑ API

- –ü–µ—Ä–µ—Ö–æ–¥–∏–º –≤ –ø–∞–ø–∫—É `api` –∏ –∑–∞–ø—É—Å–∫–∞–µ–º:
```
docker build -t my-api .
```
- –ó–∞–ø—É—Å—Ç–∏–º API-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∏–∑ –æ–±—Ä–∞–∑–∞ `my-api` –ø–æ–¥ –∏–º–µ–Ω–µ–º `api-container`:
```
docker run -d --name api-container -p 5000:5000 my-api
```
–ü—Ä–æ–≤–µ—Ä—è–µ–º, —Ä–∞–±–æ—Ç–∞–µ—Ç –∏–ª–∏ –Ω–µ—Ç:
```
curl http://localhost:5000
```
#### üì¶ 2. –¢–µ–ø–µ—Ä—å —Å–æ–∑–¥–∞–¥–∏–º –æ–±—Ä–∞–∑ –∫–ª–∏–µ–Ω—Ç–∞

- –ü–µ—Ä–µ—Ö–æ–¥–∏–º –≤ –ø–∞–ø–∫—É client 

–ü—Ä–µ–∂–¥–µ –≤—Å–µ–≥–æ, –Ω–∞–¥–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å—Å—è, –∫–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º –∫–ª–∏–µ–Ω—Ç –±—É–¥–µ—Ç —Å —Å–≤—è–∑—ã–≤–∞—Ç—å—Å—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º.  
–í–æ–∑–º–æ–∂–Ω—ã 2 –≤–∞—Ä–∏–∞–Ω—Ç–∞:
- –Ω–∞–π—Ç–∏ ip –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –≤ –æ–±—â–µ–π —Å–µ—Ç–∏ –∏ –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –ø–æ —ç—Ç–æ–º—É IP
- –¥–ª—è —ç—Ç–æ–π —Ü–µ–ª–∏ —Å–æ–∑–¥–∞—Ç—å —Å–≤–æ—é —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—É—é docker-—Å–µ—Ç—å
- 
##### üîÑ –í–∞—Ä–∏–∞–Ω—Ç 1 (–Ω–µ –Ω–∞—à —Å–ª—É—á–∞–π): –ó–∞–º–µ–Ω–∏—Ç—å –∞–¥—Ä–µ—Å API –≤ client.py –Ω–∞ IP

- –î–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ API-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—É –æ–ø—Ä–µ–¥–µ–ª–∏–º –µ–≥–æ IP
``` 
docker inspect -f '{{range .NetworkSettings.Networks}}{{.IPAddress}}{{end}}' api-container
```
- –†–µ–∑—É–ª—å—Ç–∞—Ç –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—Å—è –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ. –ù–∞–ø—Ä–∏–º–µ—Ä, –≤–æ—Ç —Ç–∞–∫–æ–π:
```
172.17.0.2
```
–ß—Ç–æ–±—ã –∫–ª–∏–µ–Ω—Ç –∑–Ω–∞–ª, –∫—É–¥–∞ –æ–±—Ä–∞—â–∞—Ç—å—Å—è ‚Äî –Ω—É–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å IP —Å–µ—Ä–≤–µ—Ä–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –≤ –∫–æ–¥–µ:

- –ò–∑–º–µ–Ω—è–µ–º –∫–ª–∏–µ–Ω—Ç—Å–∫–∏–π —Å–∫—Ä–∏–ø—Ç:
  - –º–µ–Ω—è–µ–º url –∑–∞–ø—Ä–æ—Å–∞ –Ω–æ–º–µ—Ä –ø–æ–ª—É—á–µ–Ω–Ω–æ–≥–æ IP, –Ω–∞–ø—Ä–∏–º–µ—Ä:
    ```
    response = requests.get("http://172.17.0.2:5000/")
    ```

  - –ó–∞–ø—É—Å–∫–∞–µ–º –∫–ª–∏–µ–Ω—Ç-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä, –ø–µ—Ä–µ–¥–∞–≤–∞—è IP API:
  ```
  docker run -d --name client-container my-client
  ```


##### üîÑ –í–∞—Ä–∏–∞–Ω—Ç 2 (–Ω–∞—à –≤–∞—Ä–∏–∞–Ω—Ç): —Å–æ–∑–¥–∞—Ç—å —Å–≤–æ—é docker-—Å–µ—Ç—å, —á—Ç–æ –≥–æ—Ä–∞–∑–¥–æ —É–¥–æ–±–Ω–µ–π  
(–Ω–µ –Ω—É–∂–Ω–æ –≤—Ä—É—á–Ω—É—é –º–µ–Ω—è—Ç—å –∫–æ–¥ –∫–ª–∏–µ–Ω—Ç–∞ –∏ –ø–µ—Ä–µ—Å–æ–±–∏—Ä–∞—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –ø—Ä–∏ —Å–º–µ–Ω–µ ip)
- —Å–æ–∑–¥–∞—ë–º —Å–µ—Ç—å `mynetwork`
```
docker network create mynetwork
```
- –ø—Ä–æ–≤–µ—Ä—è–µ–º —Å–µ—Ç—å
```
docker network ls
```
- –∏ –≤–∏–¥–∏–º –ø–æ—è–≤–ª–µ–Ω–∏–µ –Ω–∞—à–µ–π —Å–µ—Ç–∏:
```
NETWORK ID     NAME        DRIVER    SCOPE
1b80adeac0a0   bridge      bridge    local
0e1153d9ce2a   host        host      local
59411aeb4ee1   mynetwork   bridge    local
8f7d2caf3549   none        null      local
```

- –ó–∞–ø—É—Å–∫–∞–µ–º API –≤ —ç—Ç–æ–π —Å–µ—Ç–∏:
```
docker run -d --name api-container --network mynetwork my-api
```

–ï—Å–ª–∏ —Å–∞–π—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤–∏–¥–µ–Ω –Ω–µ —Ç–æ–ª—å–∫–æ –≤–Ω—É—Ç—Ä–∏ —Å–µ—Ç–∏, –Ω–æ –µ—â—ë –∏ "—Å–Ω–∞—Ä—É–∂–∏",  
–Ω–∞–º –Ω—É–∂–Ω–æ —è–≤–Ω–æ "–ø—Ä–æ–±—Ä–æ—Å–∏—Ç—å" –ø–æ—Ä—Ç 5000 –Ω–∞—Ä—É–∂—É, —Ç–æ –µ—Å—Ç—å –Ω–∞ `localhost:5000`:
```
docker run -d --name api-container -p 5000:5000 --network mynetwork my-api
```

–¢–µ–ø–µ—Ä—å –≤ client.py –º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –∞–¥—Ä–µ—Å —Å–µ—Ä–≤–µ—Ä–∞:
```
response = requests.get("http://api-container:5000/")
```

–∏ —Å–æ–∑–¥–∞—ë–º –∫–ª–∏–µ–Ω—Ç—Å–∫–∏–π image, –∑–∞–ø—É—Å—Ç–∏–≤ –∫–æ–º–∞–Ω–¥—É –≤ –ø–∞–ø–∫—É –∫–ª–∏–µ–Ω—Ç–∞:
```
docker build -t my-client .
```

–ê —Ç–µ–ø–µ—Ä—å –∑–∞–ø—É—Å–∫–∞–µ–º –∫–ª–∏–µ–Ω—Ç–∞ –≤ —Ç–æ–π –∂–µ —Å–µ—Ç–∏, –∏ –æ–Ω –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏–º—è api-container –∫–∞–∫ —Ö–æ—Å—Ç:
```
docker run -d --name client-container --network mynetwork my-client
```

üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è:

    docker ps ‚Äî —Å–ø–∏—Å–æ–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤

    docker logs client-container ‚Äî –ª–æ–≥ –∫–ª–∏–µ–Ω—Ç–∞

    docker stop/start –∏ —Ç.–¥.



